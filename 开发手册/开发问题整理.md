    [TOC]
# 开发过程中出现的各类问题整理

## IDEA开发中的问题及注意项

### 1.IDEA console出现乱码

- 1.修改IDEA的配置文件

> 打开Intellij的安装的bin目录，找到`idea.exe.vmoptions`和`idea64.exe.vmoptions`两个文件（根据你的系统是32位或64位选择其中一个配置文件），在配置文件中添加：

```bash
-Dfile.encoding=UTF-8
```

- 2.配置项目编码及IDE编码

> 进入settings，选择File Encodings，把IDE Encoding和Project Encoding配置为UTF-8，同时将下面的Default encoding for properties files也配置为UTF-8。

![](https://images2015.cnblogs.com/blog/1072889/201703/1072889-20170329113230061-1048865608.png)

- 3.配置项目启动服务器参数，在tomcat配置中

在VM options 项中添加

```
-Dfile.encoding=UTF-8
```


### 2.IDEA 中spring boot 多模块项目


SpringBoot多模块项目实践（Multi-Module）-<https://segmentfault.com/a/1190000011367492>

## maven

### 1.maven中引用父类`pom`时，怎么在子模块中引入父类包？还有子模块中${project.version}指代的什么版本？

这个可以参考我的博客，[**关于多模块项目中的依赖管理**]<https://nezhaxiaozi.coding.me/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/2018-11-07-Maven%E4%B8%AD%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E5%A4%9A%E6%A8%A1%E5%9D%97%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB/>

### 2.maven中怎么将一个空项目编程Spring Boot项目

- 1.首先是增加依赖包，主要是`spring-boot-starter`

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
    </dependency>
</dependencies>
```

- 2.在`resources`的文件夹中增加配置文件`application.properties`

> 这个一般是spring boot有默认的文件名

- 3.在包路径根目录下增加Spring Boot启动类

```java
package com.nezha.learn.demo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class DemoRedisApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoRedisApplication.class, args);
    }
}
```

- 4.如果需要使用测试类，可以增加同样的包路径和注解

```java
package com.nezha.learn.demo;

import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
public class DemoRedisApplicationTest {

}
```

## Java

### 1.为什么Java的实体类需要实现Serializable接口

**参考文献：Java类中serialversionuid 作用 是什么?举个例子说明<https://www.cnblogs.com/duanxz/p/3511695.html>**

> Java的序列化机制是通过判断类的serialVersionUID来验证版本一致性的。在进行反序列化时，JVM会把传来的字节流中的serialVersionUID与本地相应实体类的serialVersionUID进行比较，如果相同就认为是一致的，可以进行反序列化，否则就会出现序列化版本不一致的异常，即是InvalidCastException。

## Spring

### 1.为什么Spring使用接口注入，而不是实现类（而且不是显示的指代接口的实现类）

> Spring Boot 注入接口 @Autowired interface:<https://www.jianshu.com/p/3942cce05f71>

### 2.如果spring的版本修改后，和pom的其他依赖不一样，可不可以

> 这个一般都是统一管理依赖版本的，依赖版本不一致很有可能出现各种错误的

### 3.Spring boot中自定义的配置怎么加载和读取

### 4.Spring项目中classpath指代哪个路径

[Java][MyBatis]mapperLocations属性通配符的使用- <https://blog.csdn.net/szwangdf/article/details/23432783>

### 5.**Junit集成测试--Mock**

1. http://sishuok.com/forum/blogPost/list/7981.html
2. http://www.cnblogs.com/0201zcr/p/5756642.html

**Junit 按顺序排序**

```
@FixMethodOrder(MethodSorters.DEFAULT)
```

### 6.SpringBoot 多模块项目（module）Service自动注入（`@Autowired`）

> SpringBoot 多模块项目（module）Service自动注入（@Autowired）<https://blog.csdn.net/machuang30508/article/details/78616501>
SpringBoot中Service自动注入很方便，例：

- `Service.class`（接口类）
- `ServiceImpl.class`（实现类）
- `Controller.class`（使用类）
用以上三个类来说一下自动注入：

**单项目：分别`ServiceImpl`头上`@Service`，`Controller`中`Service`对象`@Autowired`即可享用；**

Multi modules 场景，三个（种）类分别在三个module下：

- `moduleA` : `Service.class`（com.example.moduleA ）
- `moduleB` : `ServiceImpl.class` ( com.example.moduleB )
- `moduleC` : `Controller.class` ( com.example.moduleC )

> 此时B依赖A，C依赖A、B，添加好依赖关系。

如何自动注入？接口、实现、使用类，姿势不变,按单项目方式写即可;

如果你已经试过`scanBasePackages`，无论是在`@SpringBootApplication`方式还是`@ComponentScan`；
抑或试过`@SpringBootApplication`、`@ComponentScan`同时用，当你这么做时，一定是绝望的。

解决办法:**`@SpringBootApplictaion(scanBasePackages="com.example")`**
核心就是：
**`Service` 及 `ServiceImpl`均需在`com.example`包下**

因为`Service`、`ServiceImpl`同在`com.example`下（C可以不在），所以我看作是同一次scan过程；
当然（`@ComponentScan="com.example"`）也是可以的，因为前者`@SpringBootApplication`已经包含`@ComponentScan`；


## MySQL


## Docker的使用

### 1.安装Docker

> https://download.docker.com/mac/stable/Docker.dmg


### 2.Docker上安装Redis

```shell
#!/bin/sh
name=redis
image=redis:2.8.6
docker stop $name
docker rm -v $name
docker run -d --name  $name -p "6379:6379" --restart always $image
```

- 进入交互模式

```bash
docker exec -it redis  /bin/bash
```

### 3.集成zookeeper和Kafka

> 参考文献：[docker环境下的zookeeper和kafka部署](http://www.jianshu.com/p/263164fdcac7)

- 1.下载docker镜像

```bash
zookeeker: docker pull zookeeper:latest
kafka: docker pull wurstmeister/kafka:latest
```

- 2.创建并启动容器

**先启动zookeeper:**

```bash
docker run -d --name zookeeper --publish 2181:2181 --volume /etc/localtime:/etc/localtime zookeeper:latest
```


**zookeeper启动完成后再启动kafka:**

```bash
docker run -d --name kafka --publish 9092:9092 --link zookeeper --env KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 --env KAFKA_ADVERTISED_HOST_NAME=kafka所在宿主机的IP --env KAFKA_ADVERTISED_PORT=9092 --volume /etc/localtime:/etc/localtime wurstmeister/kafka:latest
```

**再次启动的时候**

```bash
# 显示所有的容器
docker ps -a
docker start ${CONTAINER ID}
```

- 3.向kafka发送测试消息

1.运行 `docker ps`，找到kafka的 CONTAINER ID，运行 `docker exec -it ${CONTAINER ID} /bin/bash`，进入kafka容器。

2.进入kafka默认目录 `/opt/kafka_2.11-0.10.1.0`，运行 `bin/kafka-topics.sh --create --zookeeper zookeeper:2181 --replication-factor 1 --partitions 1 --topic test`，创建一个 topic 名称为 test。

3.运行 `bin/kafka-topics.sh --list --zookeeper zookeeper:2181` 查看当前的 topic 列表。

4.运行一个消息生产者，指定 topic 为刚刚创建的 test ， `bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test`，输入一些测试消息。

5.运行一个消息消费者，同样指定 topic 为 test， `bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning`，可以接收到生产者发送的消息。


> `docker exec c151bb4b9877 zkCli.sh -server localhost:2181`

### 4.Docker 集成elasticsearch

```bash
#!/bin/sh
name=es
image=elasticsearch:2.1.2
docker stop $name
docker rm -v $name
docker run -d --name $name -p "9200:9200" -p "9300:9300" -v  /Users/a123/shell/config:/usr/share/elasticsearch/config  --restart always $image
```

文件的地址在：`localhost:9200/_cat`


### 5.Docker 集成RabbitMQ

```bash
#!/bin/sh
name=rabbitmq
image=rabbitmq:3-management
docker stop $name
docker rm -v $name
docker run -d --name  $name -p "5672:5672"  -p "15672:15672" --restart always $image
```